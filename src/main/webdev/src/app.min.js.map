{"version":3,"sources":["app.min.js"],"names":["angular","module","config","$stateProvider","$urlRouterProvider","state","url","templateUrl","controller","otherwise","service","$http","$q","getData","data","deferred","defer","method","params","then","answer","status","resolve","error","reject","promise","constant","name","color","factory","$window","set","key","value","localStorage","get","setObject","JSON","stringify","getObject","parse","width","document","documentElement","clientWidth","height","clientHeight","$scope","getViewport","colorMap","visService","$interval","$filter","currentTime","viewTime","Date","valueOf","timeRange","show","close","records","map","AMap","Map","mapStyle","zoom","center","setFeatures","AMapUI","load","PointSimplifier","utils","$","MyCanvasRender","pointSimplifierIns","opts","__super__","constructor","apply","this","arguments","supportCanvas","alert","inherit","Render","Canvas","extend","prototype","renderNormalPoints","activePoints","shadowPoints","call","pointStyle","getOption","getPointsGroupKey","pointStyleGroup","getPointSimplifierInstance","groups","i","len","length","point","dataIndex","idx","dataItem","getDataItemByIndex","push","k","styleOptions","drawPointsWithStyleOptions","getPosition","item","parseFloat","lng","lat","getHoverTitle","content","autoSetFitView","renderConstructor","renderOptions","fillStyle","hoverTitleStyle","position","type","g0","g1","g2","g3","g4","g5","g6","g7","g8","g9","g10","g11","g12","on","e","record","xScale","yScale","w","h","timeLine","d3","select","append","attr","max","areas","stime","etime","setData","maps","showTooltip","left","top","text","style","classed","hideTooltip","scale","ordinal","domain","range","rangeRoundBands","d","num","linear","selectAll","enter","rangeBand","transition","duration","showPoint","console","log","showContent","typeName","para","startTime","endTime","area","start","intervalEvent","parseInt","shift","flag","stop","cancel","months","currentMonth","data0","index","data1","data2","directive","restrict","scope","template","link","element","chart","find","echarts","init","setOption","title","textStyle","fontSize","tooltip","trigger","axisPointer","lineStyle","label","backgroundColor","right","grid","bottom","containLabel","dataZoom","realtime","end","legend","obj","xAxis","boundaryGap","axisLine","onZero","axisLabel","axisTick","time","yAxis","splitLine","splitArea","series","stack","normal","opacity","areaStyle","smooth","smoothMonotone","symbolSize","showSymbol","hoverAnimation","interval","barWidth","itemStyle","pieData","second","x","formatter","selectedMode","radius","labelLine","first"],"mappings":"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","file":"app.min.js","sourcesContent":["/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 路由配置\r\n */\r\n\r\nangular.module('chinavis', ['ngAnimate', 'ui.router'])\r\n    .config([\"$stateProvider\", \"$urlRouterProvider\", function ($stateProvider, $urlRouterProvider) {\r\n        $stateProvider\r\n            .state('situation', {\r\n                url: '/',\r\n                templateUrl: '../situation/situation.html',\r\n                controller: 'situationController'\r\n            })\r\n            .state('analysis', {\r\n                url: '/analysis',\r\n                templateUrl: '../analysis/analysis.html',\r\n                controller: 'analysisController'\r\n            });\r\n        $urlRouterProvider.otherwise('/');\r\n    }]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: xhr请求\r\n */\r\n\r\nangular.module('chinavis')\r\n    .service('visService', ['$http', '$q', function ($http, $q) {\r\n        return {\r\n            getData: function (url, data) {\r\n                var deferred = $q.defer();\r\n                var promise = $http({\r\n                    method: 'GET',\r\n                    url: url,\r\n                    params: data\r\n                });\r\n                promise.then(\r\n                    // 通讯成功的处理\r\n                    function (answer) {\r\n                        // 在这里可以对返回的数据集做一定的处理,再交由controller进行处理\r\n                        answer.status = true;\r\n                        deferred.resolve(answer.data);\r\n                    },\r\n                    // 通讯失败的处理\r\n                    function (error) {\r\n                        // 可以先对失败的数据集做处理，再交由controller进行处理\r\n                        error.status = false;\r\n                        deferred.reject(error);\r\n                    });\r\n                // 返回promise对象，交由controller继续处理成功、失败的业务回调\r\n                return deferred.promise;\r\n            }\r\n        }\r\n    }]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 常用颜色\r\n */\r\n\r\nangular.module('chinavis')\r\n    .constant('colorMap', [\r\n        {\r\n            name: '上门服务',\r\n            color: '#17becf'\r\n        },\r\n        {\r\n            name: '代开发票',\r\n            color: '#1f77b4'\r\n        },\r\n        {\r\n            name: '赌博麻将',\r\n            color: '#ff7f0e'\r\n        },\r\n        {\r\n            name: '办证刻章',\r\n            color: '#2ca02c'\r\n        },\r\n        {\r\n            name: '银行诈骗',\r\n            color: '#d62728'\r\n        },\r\n        {\r\n            name: '苹果诈骗',\r\n            color: '#9467bd'\r\n        },\r\n        {\r\n            name: '房地产广告',\r\n            color: '#8c564b'\r\n        },\r\n        {\r\n            name: '贷款服务',\r\n            color: '#e377c2'\r\n        },\r\n        {\r\n            name: '各类广告',\r\n            color: '#bcbd22'\r\n        },\r\n        {\r\n            name: '招聘信息',\r\n            color: '#17becf'\r\n        },\r\n        {\r\n            name: '诽谤谣言',\r\n            color: '#5878cf'\r\n        },\r\n        {\r\n            name: '中国移动',\r\n            color: '#74b0a1'\r\n        },\r\n        {\r\n            name: '收驾驶证',\r\n            color: '#b09355'\r\n        }\r\n    ]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 读写localStorage\r\n */\r\n\r\nangular.module('chinavis')\r\n    .factory('localStorage', ['$window', function ($window) {\r\n        return {\r\n            // 存储单个属性\r\n            set: function (key, value) {\r\n                $window.localStorage[key] = value;\r\n            },\r\n            // 读取单个属性\r\n            get: function (key) {\r\n                return $window.localStorage[key] || '';\r\n            },\r\n            // 存储对象，以JSON格式存储\r\n            setObject: function (key, value) {\r\n                $window.localStorage[key] = JSON.stringify(value);\r\n            },\r\n            // 读取对象\r\n            getObject: function (key) {\r\n                return JSON.parse($window.localStorage[key] || '{}');\r\n            }\r\n        }\r\n    }]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 获取浏览器宽度和高度\r\n */\r\n\r\nangular.module('chinavis')\r\n    .factory('getViewport', function () {\r\n        return {\r\n            width: document.documentElement.clientWidth,\r\n            height: document.documentElement.clientHeight\r\n        }\r\n    });\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 态势模块\r\n */\r\n \r\nangular.module('chinavis')\r\n    .controller('situationController', ['$scope', 'localStorage', 'getViewport', 'colorMap', 'visService', '$interval', '$filter', function ($scope, localStorage, getViewport, colorMap, visService, $interval, $filter) {\r\n        $scope.colorMap = colorMap;// 分类及对应颜色\r\n        $scope.currentTime = '2017-02-24 10:00:00';// 当前时间\r\n        $scope.viewTime = new Date($scope.currentTime).valueOf() - 1800000;// 回退时间\r\n        localStorage.set('startTime', (new Date($scope.currentTime).valueOf()) / 1000);// 转化为时间戳存储在localStorage\r\n        $scope.timeRange = '';\r\n        $scope.show = false;// 是否显示短信内容\r\n        $scope.close = function () {\r\n            $scope.show = false;\r\n        };// 关闭短信内容\r\n        $scope.records = [];// 短信内容\r\n\r\n\r\n        // 创建地图\r\n        var map = new AMap.Map('container', {\r\n            mapStyle: 'amap://styles/grey',\r\n            zoom: 11,\r\n            center: [116.403909, 39.915212]\r\n        });\r\n\r\n        map.setFeatures(['road', 'bg']);// 多个种类要素显示\r\n        AMapUI.load(['ui/misc/PointSimplifier', 'lib/utils', 'lib/$'], function (PointSimplifier, utils, $) {\r\n            if (!PointSimplifier.supportCanvas) {\r\n                alert('当前环境不支持 Canvas！');\r\n                return;\r\n            }\r\n\r\n            function MyCanvasRender(pointSimplifierIns, opts) {\r\n                // 直接调用父类的构造函数\r\n                MyCanvasRender.__super__.constructor.apply(this, arguments);\r\n            }\r\n\r\n            // 继承自默认的Canvas引擎（http://webapi.amap.com/ui/1.0/ui/misc/PointSimplifier/render/canvas.js）\r\n            utils.inherit(MyCanvasRender, PointSimplifier.Render.Canvas);\r\n\r\n            utils.extend(MyCanvasRender.prototype, {\r\n                renderNormalPoints: function (zoom, activePoints, shadowPoints) {\r\n                    // 先按默认逻辑处理shadowPoints\r\n                    MyCanvasRender.__super__.renderNormalPoints.call(this, zoom, null, shadowPoints);\r\n\r\n                    var pointStyle = this.getOption('pointStyle'),\r\n                        getPointsGroupKey = this.getOption('getPointsGroupKey'),\r\n                        pointStyleGroup = this.getOption('pointStyleGroup'),\r\n                        pointSimplifierIns = this.getPointSimplifierInstance(),\r\n                        groups = {};\r\n\r\n                    // 按key分组\r\n                    for (var i = 0, len = activePoints.length; i < len; i++) {\r\n\r\n                        var point = activePoints[i],\r\n                            dataIndex = point.idx,\r\n                            dataItem = pointSimplifierIns.getDataItemByIndex(dataIndex);\r\n\r\n                        var key = getPointsGroupKey.call(this, dataItem, dataIndex);\r\n\r\n                        if (!groups[key]) {\r\n                            groups[key] = [];\r\n                        }\r\n\r\n                        groups[key].push(activePoints[i]);\r\n                    }\r\n\r\n                    // 分组绘制\r\n                    for (var k in groups) {\r\n\r\n                        // 继承pointStyle中的默认属性\r\n                        var styleOptions = utils.extend({}, pointStyle, pointStyleGroup[k]);\r\n\r\n                        // 调用父类的绘制函数\r\n                        this.drawPointsWithStyleOptions(groups[k], styleOptions);\r\n                    }\r\n                }\r\n            });\r\n\r\n            var pointSimplifierIns = new PointSimplifier({\r\n                map: map, // 所属的地图实例\r\n\r\n                getPosition: function (item) {\r\n\r\n                    if (!item) {\r\n                        return null;\r\n                    }\r\n\r\n                    // 返回经纬度\r\n                    return [parseFloat(item.lng), parseFloat(item.lat)];\r\n                },\r\n                getHoverTitle: function (dataItem) {\r\n                    return dataItem.content;\r\n                },\r\n                autoSetFitView: false,\r\n                // 赋值为 MyCanvasRender\r\n                renderConstructor: MyCanvasRender,\r\n                renderOptions: {\r\n                    // 点的样式\r\n                    pointStyle: {\r\n                        width: 5,\r\n                        height: 5,\r\n                        fillStyle: '#d939bd'\r\n                    },\r\n                    // 鼠标hover时的title信息\r\n                    hoverTitleStyle: {\r\n                        position: 'top'\r\n                    },\r\n                    getPointsGroupKey: function (dataItem) {\r\n                        // 这里直接按索引取余，仅作示意\r\n                        return 'g' + dataItem.type;\r\n                    },\r\n                    // 分组配置\r\n                    pointStyleGroup: {\r\n                        'g0': {\r\n                            fillStyle: colorMap[0].color\r\n                        },\r\n                        'g1': {\r\n                            fillStyle: colorMap[1].color\r\n                        },\r\n                        'g2': {\r\n                            fillStyle: colorMap[2].color\r\n                        },\r\n                        'g3': {\r\n                            fillStyle: colorMap[3].color\r\n                        },\r\n                        'g4': {\r\n                            fillStyle: colorMap[4].color\r\n                        },\r\n                        'g5': {\r\n                            fillStyle: colorMap[5].color\r\n                        },\r\n                        'g6': {\r\n                            fillStyle: colorMap[6].color\r\n                        },\r\n                        'g7': {\r\n                            fillStyle: colorMap[7].color\r\n                        },\r\n                        'g8': {\r\n                            fillStyle: colorMap[8].color\r\n                        },\r\n                        'g9': {\r\n                            fillStyle: colorMap[9].color\r\n                        },\r\n                        'g10': {\r\n                            fillStyle: colorMap[10].color\r\n                        },\r\n                        'g11': {\r\n                            fillStyle: colorMap[11].color\r\n                        },\r\n                        'g12': {\r\n                            fillStyle: colorMap[12].color\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            pointSimplifierIns.on('pointClick', function (e, record) {\r\n                //console.log(e.type, record.data.recitime);\r\n            });\r\n\r\n\r\n            // 绘制时间线\r\n            var w = getViewport.width, h = 97;\r\n            var timeLine = d3.select(\"#area-stack\").append(\"svg\").attr(\"width\", w).attr(\"height\", h);\r\n            var xScale, yScale, max = 0;\r\n\r\n            // 初始化数据\r\n            visService.getData('data/First-day.json', {}).then(\r\n                function (data) {\r\n                    // 初始化时间\r\n                    $scope.timeRange = '当前时间：' + $filter('date')(data.areas[data.areas.length - 1].stime, 'yyyy年M月d日')\r\n                        + $filter('date')(data.areas[data.areas.length - 1].stime, ' HH:mm ')\r\n                        + \"至\" + $filter('date')(data.areas[data.areas.length - 1].etime, ' HH:mm');\r\n\r\n                    // 初始化地图数据\r\n                    pointSimplifierIns.setData(data.maps);\r\n\r\n                    // 初始化timeLine数据\r\n                    $scope.areas = data.areas;\r\n\r\n                    // 显示tooltip\r\n                    $scope.showTooltip = function (left, top, text) {\r\n                        // 更新tooltip信息\r\n                        d3.select(\"#tooltip\")\r\n                            .style(\"left\", left + \"px\")\r\n                            .style(\"top\", top + \"px\")\r\n                            .select(\"#value\")\r\n                            .text(text);\r\n                        d3.select(\"#tooltip\").classed(\"hidden\", false);\r\n                    };\r\n\r\n                    // 隐藏tooltip\r\n                    $scope.hideTooltip = function () {\r\n                        d3.select(\"#tooltip\").classed(\"hidden\", true);\r\n                    };\r\n\r\n                    xScale = d3.scale.ordinal()\r\n                        .domain(d3.range(data.areas.length))\r\n                        .rangeRoundBands([0, w], 0.05);\r\n\r\n                    $scope.areas.map(function (d) {\r\n                        if (d.num > max) {\r\n                            max = d.num;\r\n                        }\r\n                    });\r\n\r\n                    yScale = d3.scale.linear()\r\n                        .domain([0, max])\r\n                        .range([1, h]);\r\n\r\n                    // 柱状图\r\n                    timeLine.selectAll(\"rect\")\r\n                        .data($scope.areas)\r\n                        .enter()\r\n                        .append(\"rect\")\r\n                        .attr(\"x\", function (d, i) {\r\n                            return xScale(i);\r\n                        })\r\n                        .attr(\"y\", function (d) {\r\n                            return h - yScale(d.num);\r\n                        })\r\n                        .attr(\"width\", xScale.rangeBand())\r\n                        .attr(\"height\", function (d) {\r\n                            return yScale(d.num);\r\n                        })\r\n                        .attr(\"fill\", function (d, i) {\r\n                            return (i === 47) ? \"rgba(255,255,255,0.9)\" : \"rgba(255,255,255,0.5)\";\r\n                        })\r\n                        .attr(\"cursor\", \"pointer\")\r\n                        .on(\"mouseover\", function (d) {\r\n                            var left = d3.select(this).attr(\"x\") - 35;\r\n                            // 修正x位置\r\n                            if (left < 0) {\r\n                                left = 20;\r\n                            } else if (left + 100 > getViewport.width) {\r\n                                left = parseFloat(getViewport.width - 130);\r\n                            }\r\n                            var top = d3.select(this).attr(\"y\") - 30;\r\n\r\n                            // 显示tooltip\r\n                            $scope.showTooltip(left, top, $filter('date')(d.stime, 'M月d日HH:mm') + '-' + $filter('date')(d.etime, 'HH:mm'));\r\n\r\n                            d3.select(this)\r\n                                .transition()\r\n                                .duration(100)\r\n                                .attr(\"y\", function (d) {\r\n                                    return h - yScale(d.num) - 5;\r\n                                });\r\n                        })\r\n                        .on(\"mouseout\", function () {\r\n                            // 隐藏tooltip\r\n                            $scope.hideTooltip();\r\n\r\n                            d3.select(this)\r\n                                .transition()\r\n                                .duration(100)\r\n                                .attr(\"y\", function (d) {\r\n                                    return h - yScale(d.num);\r\n                                });\r\n                        })\r\n                        .on(\"click\", function (d) {\r\n                            // 重置所有矩形样式\r\n                            timeLine.selectAll(\"rect\")\r\n                                .transition()\r\n                                .duration(100)\r\n                                .attr(\"fill\", \"rgba(255,255,255,0.5)\");\r\n\r\n                            // 设置当前矩形样式\r\n                            d3.select(this)\r\n                                .transition()\r\n                                .duration(100)\r\n                                .attr(\"fill\", \"rgba(255,255,255,0.9)\");\r\n\r\n                            $scope.showPoint(d.stime, d.etime);\r\n                        });\r\n\r\n                    // 标签\r\n                    timeLine.selectAll(\"text\")\r\n                        .data($scope.areas)\r\n                        .enter()\r\n                        .append(\"text\")\r\n                        .text(function (d) {\r\n                            return d.num > 1000 ? d.num : '';\r\n                        })\r\n                        .attr(\"text-anchor\", \"middle\")\r\n                        .attr(\"x\", function (d, i) {\r\n                            return xScale(i) + xScale.rangeBand() / 2;\r\n                        })\r\n                        .attr(\"y\", function (d) {\r\n                            return h - yScale(d.num) + 10;\r\n                        })\r\n                        .attr(\"font-size\", \"10px\")\r\n                        .attr(\"fill\", \"#0a141b\")\r\n                        .attr(\"pointer-events\", \"none\");\r\n\r\n                },\r\n                function (error) {\r\n                    console.log(error);\r\n                });\r\n\r\n            // 查看短信内容\r\n            $scope.showContent = function (typeName) {\r\n                var type = -1;\r\n                colorMap.map(function (d, i) {\r\n                    if (d.name === typeName) type = i;\r\n                });\r\n                var para = {\r\n                    startTime: ($scope.viewTime) / 1000,\r\n                    endTime: ($scope.viewTime + 1800000) / 1000,\r\n                    type: type\r\n                };\r\n                visService.getData('./api/content', para).then(\r\n                    function (data) {\r\n                        $scope.records = data;\r\n                        $scope.show = true;\r\n                    },\r\n                    function (error) {\r\n                        console.log(error);\r\n                    });\r\n            };\r\n\r\n            // 历史回退\r\n            $scope.showPoint = function (stime, etime) {\r\n                // 重置content数据\r\n                $scope.viewTime = stime;\r\n                $scope.show = false;\r\n                $scope.records = [];\r\n\r\n                var para = {\r\n                    startTime: stime / 1000,\r\n                    endTime: etime / 1000,\r\n                    type: -1\r\n                };\r\n                visService.getData('./api/position', para).then(\r\n                    function (data) {\r\n                        // 更新地图数据\r\n                        pointSimplifierIns.setData(data.maps);\r\n\r\n                        // 更新时间\r\n                        $scope.timeRange = '当前时间：' + $filter('date')(data.area.stime, 'yyyy年M月d日')\r\n                            + $filter('date')(data.area.stime, ' HH:mm ')\r\n                            + \"至\" + $filter('date')(data.area.etime, ' HH:mm');\r\n                    },\r\n                    function (error) {\r\n                        console.log(error);\r\n                    });\r\n            };\r\n\r\n            // 开始按钮点击事件\r\n            $scope.start = function () {\r\n                $scope.intervalEvent = $interval(function () {\r\n                    var para = {\r\n                        startTime: parseInt(localStorage.get('startTime')),\r\n                        endTime: parseInt(localStorage.get('startTime')) + 1800,\r\n                        type: -1\r\n                    };\r\n                    visService.getData('./api/position', para).then(\r\n                        function (data) {\r\n                            // 更新地图数据\r\n                            pointSimplifierIns.setData(data.maps);\r\n\r\n                            // 更新时间\r\n                            $scope.timeRange = '当前时间：' + $filter('date')(data.area.stime, 'yyyy年M月d日')\r\n                                + $filter('date')(data.area.stime, 'HH:mm')\r\n                                + \"至\" + $filter('date')(data.area.etime, 'HH:mm');\r\n\r\n                            // 更新时间轴数据（length=48）\r\n                            $scope.areas.push(data.area);\r\n                            $scope.areas.shift();\r\n\r\n                            // 更新y轴比例尺\r\n                            max = 0;\r\n                            $scope.areas.map(function (d) {\r\n                                if (d.num > max) {\r\n                                    max = d.num;\r\n                                }\r\n                            });\r\n                            yScale = d3.scale.linear()\r\n                                .domain([0, max])\r\n                                .range([1, h]);\r\n\r\n                            // 更新相关数据\r\n                            timeLine.selectAll(\"rect\")\r\n                                .data($scope.areas)\r\n                                .transition()\r\n                                .duration(500)\r\n                                .attr(\"y\", function (d) {\r\n                                    return h - yScale(d.num);\r\n                                })\r\n                                .attr(\"height\", function (d) {\r\n                                    return yScale(d.num);\r\n                                })\r\n                                .attr(\"fill\", function (d, i) {\r\n                                    return (i === 47) ? \"rgba(255,255,255,0.9)\" : \"rgba(255,255,255,0.5)\";\r\n                                });\r\n\r\n                            timeLine.selectAll(\"title\")\r\n                                .data($scope.areas)\r\n                                .transition()\r\n                                .duration(500)\r\n                                .text(function (d) {\r\n                                    return $filter('date')(d.stime, 'M月d日HH:mm') + '-' + $filter('date')(d.etime, 'HH:mm');\r\n                                });\r\n\r\n                            timeLine.selectAll(\"text\")\r\n                                .data($scope.areas)\r\n                                .transition()\r\n                                .duration(500)\r\n                                .text(function (d) {\r\n                                    return d.num > 1000 ? d.num : '';\r\n                                })\r\n                                .attr(\"y\", function (d) {\r\n                                    return h - yScale(d.num) + 10;\r\n                                });\r\n                        },\r\n                        function (error) {\r\n                            console.log(error);\r\n                        });\r\n\r\n                    // 重置content数据\r\n                    $scope.viewTime = parseInt(localStorage.get('startTime') * 1000);\r\n                    $scope.show = false;\r\n                    $scope.records = [];\r\n\r\n                    localStorage.set('startTime', parseInt(localStorage.get('startTime')) + 1800);\r\n                    $scope.currentTime = $filter('date')(localStorage.get('startTime') + '000', 'yyyy-MM-dd HH:mm:ss');\r\n\r\n                }, 8000);\r\n            };\r\n\r\n            $scope.flag = '开始';\r\n            $scope.stop = function (flag) {\r\n                if (flag === '暂停') {\r\n                    $interval.cancel($scope.intervalEvent);\r\n                    $scope.flag = '开始';\r\n                } else {\r\n                    $scope.start(localStorage.get('startTime'));\r\n                    $scope.flag = '暂停';\r\n\r\n                    // 重置content数据\r\n                    $scope.show = false;\r\n                    $scope.records = [];\r\n                }\r\n            };\r\n        });\r\n    }]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 分析模块\r\n */\r\n\r\nangular.module('chinavis')\r\n    .controller('analysisController', ['$scope', 'colorMap', 'visService', '$interval', '$filter', function ($scope, colorMap, visService, $interval, $filter) {\r\n        $scope.months = [\r\n            {\r\n                \"name\": \"二月\",\r\n                \"url\": \"data/M2-30min.json\"\r\n            },\r\n            {\r\n                \"name\": \"三月\",\r\n                \"url\": \"data/M3-30min.json\"\r\n            },\r\n            {\r\n                \"name\": \"四月\",\r\n                \"url\": \"data/M4-30min.json\"\r\n            }\r\n        ];\r\n        $scope.currentMonth = \"二月\";\r\n\r\n        // 初始展示二月份数据\r\n        visService.getData($scope.months[0].url, {}).then(\r\n            function (data) {\r\n                $scope.data0 = data;\r\n            },\r\n            function (error) {\r\n                $scope.error = error;\r\n            });\r\n\r\n        $scope.show = function (index) {\r\n            visService.getData($scope.months[index].url, {}).then(\r\n                function (data) {\r\n                    $scope.currentMonth = data.name;\r\n                    if (index === 0) {\r\n                        $scope.data0 = data;\r\n                        $scope.data1 = null;\r\n                        $scope.data2 = null;\r\n                    } else if (index === 1) {\r\n                        $scope.data0 = null;\r\n                        $scope.data1 = data;\r\n                        $scope.data2 = null;\r\n                    } else if (index === 2) {\r\n                        $scope.data0 = null;\r\n                        $scope.data1 = null;\r\n                        $scope.data2 = data;\r\n                    }\r\n                },\r\n                function (error) {\r\n                    $scope.error = error;\r\n                });\r\n        }\r\n    }]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 区域折线图\r\n */\r\n \r\nangular.module('chinavis')\r\n    .directive('areaChart', ['$filter', 'colorMap', function ($filter, colorMap) {\r\n        return {\r\n            restrict: 'AE',\r\n            scope: {\r\n                data: '='\r\n            },\r\n            template: '<div></div>',\r\n            link: function (scope, element) {\r\n                var chart = element.find('div')[0];\r\n                chart.style.height = '249px';\r\n                chart.style.width = '100%';\r\n\r\n                var Chart = echarts.init(chart);\r\n                Chart.setOption({\r\n                    title: {\r\n                        text: scope.data.name,\r\n                        textStyle: {\r\n                            color: '#aaaaaa',\r\n                            fontSize: 15\r\n                        },\r\n                        top: 15,\r\n                        left: 40\r\n                    },\r\n                    tooltip: {\r\n                        trigger: 'axis',\r\n                        axisPointer: {\r\n                            type: 'cross',\r\n                            lineStyle: {\r\n                                type: 'dashed',\r\n                                width: 1\r\n                            },\r\n                            label: {\r\n                                backgroundColor: '#6a7985'\r\n                            }\r\n                        },\r\n                        position: {\r\n                            right: 10,\r\n                            top: 10\r\n                        }\r\n                    },\r\n                    grid: {\r\n                        left: '1%',\r\n                        right: '2%',\r\n                        bottom: '1%',\r\n                        containLabel: true\r\n                    },// 设置图与边缘的距离\r\n                    dataZoom: [{\r\n                        show: false,\r\n                        realtime: true,\r\n                        start: 0,\r\n                        end: 50\r\n                    }, {\r\n                        type: 'inside'\r\n                    }],\r\n                    color: colorMap.map(function (item) {\r\n                        return item.color\r\n                    }),// 改变legend的颜色\r\n                    legend: {\r\n                        top: 15,\r\n                        data: colorMap.map(function (item) {\r\n                            var obj = {};\r\n                            obj.name = item.name;\r\n                            obj.textStyle = {color: item.color};\r\n                            return obj;\r\n                        })\r\n                    },\r\n                    xAxis: {\r\n                        type: 'category',\r\n                        boundaryGap: false,\r\n                        axisLine: {\r\n                            onZero: true,\r\n                            lineStyle: {\r\n                                color: '#aaaaaa'\r\n                            }\r\n                        },\r\n                        axisLabel: {\r\n                            textStyle: {\r\n                                color: '#aaaaaa'\r\n                            }\r\n                        },\r\n                        axisTick: {\r\n                            lineStyle: {\r\n                                color: '#aaaaaa'\r\n                            }\r\n                        },\r\n                        data: scope.data.value.map(function (item) {\r\n                            return $filter('date')(item.time, 'M月d日H时mm分');\r\n                        })\r\n                    },\r\n                    yAxis: {\r\n                        type: 'value',\r\n                        splitLine: {\r\n                            show: false\r\n                        },// 去除网格线\r\n                        splitArea: {\r\n                            show: false\r\n                        },// 保留网格区域\r\n                        axisLine: {\r\n                            lineStyle: {\r\n                                color: '#aaaaaa'\r\n                            }\r\n                        },\r\n                        axisLabel: {\r\n                            textStyle: {\r\n                                color: '#aaaaaa'\r\n                            }\r\n                        },\r\n                        axisTick: {\r\n                            lineStyle: {\r\n                                color: '#aaaaaa'\r\n                            }\r\n                        }\r\n                    },\r\n                    series: [\r\n                        {\r\n                            name: colorMap[0].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[0].color\r\n                                }\r\n                            },\r\n                            smooth: true,\r\n                            smoothMonotone: 'x',\r\n                            symbolSize: 0,\r\n                            showSymbol: false,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g0 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[1].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[1].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g1 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[2].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[2].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g1 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[3].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[3].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g3 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[4].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[4].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g4 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[5].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[5].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g5 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[6].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[6].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g6 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[7].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[7].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g7 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[8].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[8].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g8 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[9].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[9].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g9 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[10].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[10].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g10 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[11].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[11].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g11 || 0;\r\n                            })\r\n                        }, {\r\n                            name: colorMap[12].name,\r\n                            type: 'line',\r\n                            stack: '总量',\r\n                            lineStyle: {\r\n                                normal: {\r\n                                    opacity: 0\r\n                                }\r\n                            },\r\n                            areaStyle: {\r\n                                normal: {\r\n                                    color: colorMap[12].color\r\n                                }\r\n                            },\r\n                            symbolSize: 3,\r\n                            hoverAnimation: false,\r\n                            data: scope.data.value.map(function (item) {\r\n                                return item.g12 || 0;\r\n                            })\r\n                        }]\r\n                });\r\n            }\r\n        }\r\n    }]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 直方图\r\n */\r\n\r\nangular.module('chinavis')\r\n    .directive('barChart', ['$filter', 'colorMap', function ($filter, colorMap) {\r\n        return {\r\n            restrict: 'AE',\r\n            scope: {\r\n                data: '=',\r\n                type: '='\r\n            },\r\n            template: '<div></div>',\r\n            link: function (scope, element) {\r\n                var title = ['各时间段伪基站活跃情况', '各类短信数量对比'];\r\n\r\n                var chart = element.find('div')[0];\r\n                chart.style.height = '230px';\r\n                chart.style.width = '100%';\r\n\r\n                var Chart = echarts.init(chart);\r\n                Chart.setOption({\r\n                    title: {\r\n                        text: title[scope.type],\r\n                        textStyle: {\r\n                            color: '#aaaaaa',\r\n                            fontSize: 15\r\n                        },\r\n                        top: 15,\r\n                        left: 40\r\n                    },\r\n                    tooltip: {\r\n                        trigger: 'axis',\r\n                        axisPointer: {// 坐标轴指示器，坐标轴触发有效\r\n                            type: 'shadow'// 默认为直线，可选为：'line' | 'shadow'\r\n                        }\r\n                    },\r\n                    grid: {\r\n                        left: '1%',\r\n                        right: '2%',\r\n                        bottom: '1%',\r\n                        containLabel: true\r\n                    },// 设置图与边缘的距离\r\n                    xAxis: [\r\n                        {\r\n                            type: 'category',\r\n                            axisLine: {\r\n                                onZero: true,\r\n                                lineStyle: {\r\n                                    color: '#aaaaaa'\r\n                                }\r\n                            },\r\n                            axisLabel: {\r\n                                show: true,\r\n                                interval: 0,\r\n                                textStyle: {\r\n                                    color: '#aaaaaa'\r\n                                }\r\n                            },\r\n                            axisTick: {\r\n                                lineStyle: {\r\n                                    color: '#aaaaaa'\r\n                                }\r\n                            },\r\n                            data: scope.data.map(function (item) {\r\n                                if (scope.type === 0) return $filter('date')(item.time, 'HH:mm');\r\n                                else if (scope.type === 1) return colorMap[item.type].name;\r\n                            })\r\n                        }\r\n                    ],\r\n                    yAxis: [\r\n                        {\r\n                            type: 'value',\r\n                            splitLine: {\r\n                                show: false\r\n                            },// 去除网格线\r\n                            splitArea: {\r\n                                show: false\r\n                            },// 保留网格区域\r\n                            axisLine: {\r\n                                lineStyle: {\r\n                                    color: '#aaaaaa'\r\n                                }\r\n                            },\r\n                            axisLabel: {\r\n                                textStyle: {\r\n                                    color: '#aaaaaa'\r\n                                }\r\n                            },\r\n                            axisTick: {\r\n                                lineStyle: {\r\n                                    color: '#aaaaaa'\r\n                                }\r\n                            }\r\n                        }\r\n                    ],\r\n                    series: [\r\n                        {\r\n                            name: '总量',\r\n                            type: 'bar',\r\n                            barWidth: '60%',\r\n                            itemStyle: {\r\n                                normal: {\r\n                                    color: function (params) {\r\n                                        if (scope.type === 0) return '#3398DB';\r\n                                        else if (scope.type === 1) return (colorMap[params.dataIndex]).color\r\n                                    }\r\n                                }\r\n                            },\r\n                            data: scope.data.map(function (item) {\r\n                                return item.num\r\n                            })\r\n                        }\r\n                    ]\r\n                });\r\n\r\n            }\r\n        }\r\n    }]);\n/**\r\n * Created: OCEAN on 2017/6/22\r\n * Email: oceanstation@163.com\r\n * Description: 饼图\r\n */\r\n\r\nangular.module('chinavis')\r\n    .directive('pieChart', ['$filter', 'colorMap', function ($filter, colorMap) {\r\n        return {\r\n            restrict: 'AE',\r\n            scope: {\r\n                data: '='\r\n            },\r\n            template: '<div></div>',\r\n            link: function (scope, element) {\r\n                var pieData = [];\r\n                // 修改key并添加颜色信息\r\n                scope.data.second.map(function (item) {\r\n                    var obj = {};\r\n                    obj.name = colorMap[item.type].name;\r\n                    obj.value = item.num;\r\n                    obj.itemStyle = {\"normal\": {\"color\": colorMap[item.type].color}};\r\n                    pieData.push(obj);\r\n                });\r\n\r\n                var chart = element.find('div')[0];\r\n                chart.style.height = '490px';\r\n                chart.style.width = '100%';\r\n\r\n                var Chart = echarts.init(chart);\r\n                Chart.setOption({\r\n                    title: {\r\n                        text: '各类短信所占比例',\r\n                        x: 'center',\r\n                        bottom: 30,\r\n                        textStyle: {\r\n                            color: '#aaaaaa',\r\n                            fontSize: 15\r\n                        }\r\n                    },\r\n                    grid: {\r\n                        left: '2%',\r\n                        right: '2%',\r\n                        top: '2%',\r\n                        containLabel: true\r\n                    },// 设置图与边缘的距离\r\n                    tooltip: {\r\n                        trigger: 'item',\r\n                        formatter: \"{b}: {c} ({d}%)\"\r\n                    },\r\n                    series: [\r\n                        {\r\n                            type: 'pie',\r\n                            selectedMode: 'single',\r\n                            radius: [0, '30%'],\r\n\r\n                            label: {\r\n                                normal: {\r\n                                    position: 'inner'\r\n                                }\r\n                            },\r\n                            labelLine: {\r\n                                normal: {\r\n                                    show: false\r\n                                }\r\n                            },\r\n                            data: scope.data.first\r\n                        },\r\n                        {\r\n                            name: '访问来源',\r\n                            type: 'pie',\r\n                            radius: ['40%', '55%'],\r\n\r\n                            data: pieData\r\n                        }\r\n                    ]\r\n                });\r\n\r\n            }\r\n        }\r\n    }]);"]}